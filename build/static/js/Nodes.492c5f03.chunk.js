webpackJsonp([16],{

/***/ 2356:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
Object.defineProperty(exports,"__esModule",{value:true});var _regenerator=__webpack_require__(10);var _regenerator2=_interopRequireDefault(_regenerator);var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _index=__webpack_require__(30);var _index2=_interopRequireDefault(_index);var _reactRedux=__webpack_require__(19);var _network=__webpack_require__(1055);var _lodash=__webpack_require__(17);var _i18n=__webpack_require__(13);var _loaders=__webpack_require__(25);var _async=__webpack_require__(2957);var _url=__webpack_require__(226);var _Icon=__webpack_require__(2971);var _BarChart=__webpack_require__(2972);var _BarChart2=_interopRequireDefault(_BarChart);var _constants=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{return Promise.resolve(value).then(function(value){step("next",value);},function(err){step("throw",err);});}}return step("next");});};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}/*eslint-disable no-script-url*/var Nodes=function(_Component){_inherits(Nodes,_Component);function Nodes(props){var _this2=this;_classCallCheck(this,Nodes);var _this=_possibleConstructorReturn(this,(Nodes.__proto__||Object.getPrototypeOf(Nodes)).call(this,props));_this.buildNodeList=function(){var nodes=_this.state.nodes;var nodesByCountry={};var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=nodes[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var node=_step.value;if(!nodesByCountry[node.country]){nodesByCountry[node.country]={name:node.country,nodes:[],total:0};}nodesByCountry[node.country].nodes.push(node);nodesByCountry[node.country].total++;}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}var countries=Object.values(nodesByCountry);countries=(0,_lodash.sortBy)(countries,function(c){return c.total;});countries=(0,_lodash.filter)(countries,function(c){return c.name!=="";});countries.reverse();return countries;};_this.setCountryHover=function(activeCountry){_this.setState({activeCountry:activeCountry});};_this.loadNodes=_asyncToGenerator(/*#__PURE__*/_regenerator2.default.mark(function _callee(){var _ref2,data;return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _index2.default.get(_constants.API_URL+"/api/nodemap");case 2:_ref2=_context.sent;data=_ref2.data;_this.setState({nodes:data.data,syncStatus:null});case 5:case"end":return _context.stop();}}},_callee,_this2);}));_this.state={showAllCountries:false,size:5,nodes:[],syncStatus:"waiting",show3D:(0,_url.getQueryParam)(props.location,"mode")==="3d"};return _this;}_createClass(Nodes,[{key:"renderList",value:function renderList(){var _state=this.state,showAllCountries=_state.showAllCountries,size=_state.size;var nodes=this.state.nodes;var shownCountries=this.buildNodeList();if(!showAllCountries){shownCountries=shownCountries.slice(0,size);}if(nodes.length===0){return _react2.default.createElement("div",{className:"d-flex justify-content-center p-4"},_react2.default.createElement(_loaders.TronLoader,null));}return _react2.default.createElement("ul",{className:"list-group list-group-flush"},shownCountries.map(function(country,index){return _react2.default.createElement("li",{key:country.name,className:"list-group-item d-flex"},country.name,_react2.default.createElement("span",{className:"ml-auto"},country.total));}));}},{key:"componentDidMount",value:function componentDidMount(){this.loadNodes();}},{key:"render",value:function render(){var _state2=this.state,nodes=_state2.nodes,syncStatus=_state2.syncStatus;var countries=this.buildNodeList();if(syncStatus==="waiting_for_first_sync"){return _react2.default.createElement("main",{className:"container header-overlap"},_react2.default.createElement("div",{className:"card"},_react2.default.createElement(_loaders.TronLoader,null,(0,_i18n.tu)("first_node_sync_message"))));}if(nodes.length===0){return _react2.default.createElement("main",{className:"container header-overlap"},_react2.default.createElement("div",{className:"card"},_react2.default.createElement(_loaders.TronLoader,null,(0,_i18n.tu)("loading_nodes"))));}return _react2.default.createElement("main",{className:"container header-overlap _nodemap"},_react2.default.createElement("div",{className:"row"},_react2.default.createElement("div",{className:"col-md-6"},_react2.default.createElement("div",{className:"card h-100 text-left widget-icon bg-line_red bg-image_node"},_react2.default.createElement("div",{className:"card-body _node",style:{marginLeft:'50px'}},_react2.default.createElement("h3",{className:"text-secondary"},nodes.length),(0,_i18n.tu)("nodes")))),_react2.default.createElement("div",{className:"col-md-6 mt-3 mt-md-0"},_react2.default.createElement("div",{className:"card h-100 text-left widget-icon bg-line_green bg-image_nodest"},_react2.default.createElement("div",{className:"card-body _node",style:{marginLeft:'50px'}},countries.length>0?_react2.default.createElement("h3",{className:"text-primary"},(0,_lodash.maxBy)(countries,function(c){return c.total;}).name):_react2.default.createElement("h3",{className:"text-primary"},"Unknown"),(0,_i18n.tu)("most_nodes"))))),_react2.default.createElement("div",{className:"row mt-3"},_react2.default.createElement("div",{className:"col-md-12"},_react2.default.createElement("div",{className:"card",style:{padding:'20px'}},_react2.default.createElement(_async.NodeMapAsync,{nodes:nodes,countries:countries})))),_react2.default.createElement("div",{className:"row mt-3"},_react2.default.createElement("div",{className:"col-md-12"},_react2.default.createElement("div",{className:"card"},_react2.default.createElement("div",{className:"card-body _node"},_react2.default.createElement("h5",{className:"card-title text-center"},(0,_i18n.tu)("nodes_ranking"),_react2.default.createElement("br",null),(0,_i18n.tu)("split_by_country")),_react2.default.createElement("div",{style:{height:500}},countries===null?_react2.default.createElement(_loaders.TronLoader,null):_react2.default.createElement(_BarChart2.default,{style:{height:500},data:countries})))))));}}]);return Nodes;}(_react.Component);function mapStateToProps(state){return{// nodes: state.network.nodes,
};}var mapDispatchToProps={loadNodes:_network.loadNodes};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Nodes);

/***/ }),

/***/ 2957:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
Object.defineProperty(exports,"__esModule",{value:true});exports.NodeMapAsync=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _reactAsyncComponent=__webpack_require__(1006);var _loaders=__webpack_require__(25);var _i18n=__webpack_require__(13);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var $script=__webpack_require__(1043);var NodeMapAsync=exports.NodeMapAsync=(0,_reactAsyncComponent.asyncComponent)({LoadingComponent:function LoadingComponent(){return _react2.default.createElement("div",{className:"card"},_react2.default.createElement(_loaders.TronLoader,null,(0,_i18n.tu)("loading_map")));},resolve:function resolve(){return new Promise(function(resolve){return(// Webpack's code splitting API w/naming
__webpack_require__.e/* require.ensure */(32).then((function(require){$script("",function(){resolve(__webpack_require__(2958));});}).bind(null, __webpack_require__)).catch(__webpack_require__.oe));});}});

/***/ }),

/***/ 2971:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
Object.defineProperty(exports,"__esModule",{value:true});exports.WidgetIcon=WidgetIcon;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}function WidgetIcon(_ref){var className=_ref.className,props=_objectWithoutProperties(_ref,["className"]);return _react2.default.createElement("span",Object.assign({className:"icon-big"},props),_react2.default.createElement("i",{className:" fa-7x "+className}));}

/***/ }),

/***/ 2972:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
Object.defineProperty(exports,"__esModule",{value:true});exports.BarReact=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _reactIntl=__webpack_require__(11);var _chartConfig=__webpack_require__(292);var _chartConfig2=_interopRequireDefault(_chartConfig);var _echarts=__webpack_require__(31);var _echarts2=_interopRequireDefault(_echarts);__webpack_require__(1076);__webpack_require__(293);__webpack_require__(227);var _reactRedux=__webpack_require__(19);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var BarReact=exports.BarReact=function(_React$Component){_inherits(BarReact,_React$Component);function BarReact(props){_classCallCheck(this,BarReact);var _this=_possibleConstructorReturn(this,(BarReact.__proto__||Object.getPrototypeOf(BarReact)).call(this,props));var id=('_'+Math.random()).replace('.','_');_this.state={barId:'bar'+id};return _this;}_createClass(BarReact,[{key:'initBar',value:function initBar(id){var _props=this.props,intl=_props.intl,data=_props.data;var myChart=_echarts2.default.getInstanceByDom(document.getElementById(id));if(myChart===undefined){myChart=_echarts2.default.init(document.getElementById(id));}_chartConfig2.default.barChart.title.text='';_chartConfig2.default.barChart.yAxis.data=[];_chartConfig2.default.barChart.series[0].data=[];_chartConfig2.default.barChart.series[0].itemStyle={normal:{color:new _echarts2.default.graphic.LinearGradient(0,0,1,0,[{offset:0,color:'#ed213a'},{offset:1,color:'#93291e'}])},emphasis:{color:new _echarts2.default.graphic.LinearGradient(0,0,1,0,[{offset:0,color:'#0052d4'},{offset:1,color:'#0052d4'}])}};var dataOpt=[];var others={name:'Others',total:0};data.map(function(val){if(val.total>10&&val.name!==null){dataOpt.push(val);}else{others.total=others.total+val.total;}});dataOpt.push(others);if(dataOpt&&dataOpt.length>0){dataOpt.map(function(val){_chartConfig2.default.barChart.yAxis.data.push(val.name);_chartConfig2.default.barChart.series[0].data.push(val.total);});}if(dataOpt&&dataOpt.length===0){_chartConfig2.default.barChart.title.text="No data";}myChart.setOption(_chartConfig2.default.barChart);}},{key:'componentDidMount',value:function componentDidMount(){this.initBar(this.state.barId);}},{key:'componentDidUpdate',value:function componentDidUpdate(){this.initBar(this.state.barId);}},{key:'render',value:function render(){return _react2.default.createElement('div',null,_react2.default.createElement('div',{id:this.state.barId,style:this.props.style}));}}]);return BarReact;}(_react2.default.Component);function mapStateToProps(state){return{};}var mapDispatchToProps={};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,null,{pure:false})((0,_reactIntl.injectIntl)(BarReact));

/***/ })

});
//# sourceMappingURL=Nodes.492c5f03.chunk.js.map